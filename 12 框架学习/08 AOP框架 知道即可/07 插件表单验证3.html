<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script src='aop.js'></script>
</head>

<body>
	用户名：<input id="username" type="text"/>

	密码： <input id="password" type="password"/>
	<input id="submitBtn" type="button" value="提交"></button>
</body>
</html>
<script>
	var username = document.getElementById( 'username' ),
		password = document.getElementById( 'password' ),
		submitBtn = document.getElementById( 'submitBtn' );
//		
//	Function.prototype.before = function( beforefn ){
//		var __self = this;
//		return function(){
//			if ( beforefn.apply( this, arguments ) === false ){
//	            // beforefn 返回false 的情况直接return，不再执行后面的原函数
//				return;
//			}
//			return __self.apply( this, arguments );
//		}
//	}


	var validata = function(){
		if ( username.value === '' ){
			alert ( '用户名不能为空' );
			return false;
		}
		if ( password.value === '' ){
			alert ( '密码不能为空' );
			return false;
		}
	}
	var formSubmit = function(){
		var param = {
			username: username.value,
			password: password.value
		}
		ajax( 'http:// xxx.com/login', param );
	}

	formSubmit = formSubmit.before( validata );

	submitBtn.onclick = function(){
		formSubmit();
	}
	
</script>